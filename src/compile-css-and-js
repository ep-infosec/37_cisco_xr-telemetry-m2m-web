#!/bin/bash

# Compile the CSS
sass assets/css/site.scss assets/static/screen.css --no-cache

function cat_file()
{
    echo
    echo // ========================================
    echo //  $1
    echo // ========================================
    echo
    cat $1
}

# Compile the JS
(
    # This ensures that utility modules (which have names beginning with an
    # underscore) are at the top of the concatenated file, above any code
    # which uses the methods contained therein.
    LC_ALL=C

    cd assets/js
    echo //
    echo // Auto-generated by compile-css-and-js. DO NOT EDIT.
    echo //
    echo "'use strict';"

    for file in *.js
    do
        cat_file $file
    done
) > assets/static/js/site.js
